<!--pages/data-manage/index.wxml-->
<view class="data-manage-page">
  <view class="header">
    <text class="title">数据管理</text>
    <view class="actions">
      <van-button 
        type="primary" 
        size="small" 
        bindtap="onCopyText"
        custom-style="width: 140rpx; margin-right: 20rpx;"
      >
        <van-icon name="copy" size="16px" />
        <text class="button-text">复制文本</text>
      </van-button>
      <van-button 
        type="success" 
        size="small" 
        bindtap="onImportTap"
        custom-style="width: 140rpx;"
      >
        <van-icon name="add-o" size="16px" />
        <text class="button-text">导入数据</text>
      </van-button>
    </view>
  </view>

  <view class="export-content">
    <textarea 
      class="export-textarea" 
      value="{{exportText}}"
      disabled
      auto-height
    />
  </view>

  <!-- 导入弹窗 -->
  <van-popup 
    show="{{showImportModal}}" 
    position="bottom" 
    bind:close="onImportCancel"
    closeable
    close-icon-position="top-right"
    custom-style="height: 80%;"
  >
    <view class="import-popup">
      <view class="import-header">
        <text class="import-title">导入数据</text>
        <text class="import-tip">请粘贴导出的文本内容</text>
      </view>
      
      <view class="import-content">
        <textarea 
          class="import-textarea" 
          value="{{importText}}"
          bindinput="onImportTextChange"
          placeholder="请粘贴导出的文本内容..."
          auto-height
          maxlength="-1"
        />
      </view>

      <view class="import-result" wx:if="{{importResult.success > 0 || importResult.skipped > 0 || importResult.failed > 0}}">
        <view class="result-summary">
          <text class="result-item success">成功: {{importResult.success}}</text>
          <text class="result-item skipped">跳过: {{importResult.skipped}}</text>
          <text class="result-item failed">失败: {{importResult.failed}}</text>
        </view>
        <view class="result-details" wx:if="{{importResult.details.length > 0}}">
          <text class="details-title">详情:</text>
          <scroll-view class="details-scroll" scroll-y>
            <view class="detail-item" wx:for="{{importResult.details}}" wx:key="index">
              {{item}}
            </view>
          </scroll-view>
        </view>
      </view>

      <view class="import-actions">
        <van-button 
          type="default" 
          size="large" 
          bindtap="onImportCancel"
          custom-style="width: 45%; margin-right: 10%;"
        >
          取消
        </van-button>
        <van-button 
          type="primary" 
          size="large" 
          bindtap="onImportConfirm"
          custom-style="width: 45%;"
        >
          确认导入
        </van-button>
      </view>
    </view>
  </van-popup>
</view>

